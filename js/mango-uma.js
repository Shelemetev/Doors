var UMA={triggerHandlerFactories:{},handledScenarios:{},debug:function(e){console.debug("mango-uma: ".concat(e))},error:function(e){console.debug("mango-uma-error: ".concat(e))},regexpStartContainerRegexp:/^\/\//,regexpEndContainerRegexp:/\/\/$/};
UMA.TIME={SECOND:1e3},UMA.ETemplateType={share:"share",contacts:"contacts",offer:"offer"},UMA.EVarType={color:"color",text:"text",boolean:"boolean",image:"image",object:"object"},UMA.EPlatformType={mobile:"mobile",desktop:"desktop",any:"any"},UMA.EActionType={popup:"popup"},UMA.ETrigger={spent_time_site:"spent_time_site",spent_time_page:"spent_time_page",enter_page:"enter_page",enter_site:"enter_site",leave_page:"leave_page",manual_trigger:"manual_trigger",scroll_to_bottom:"scroll_to_bottom",break_navigation:"break_navigation"},UMA.EEventType={uma_trigger:"uma_trigger",uma_action:"uma_action"},UMA.EPopupEvents={loaded:"popup-load",action:"popup-target-action",close:"popup-close"},UMA.EConditionType={url_match:"url_match",platform:"platform",region:"region",seconds_on_page:"seconds_on_page",seconds_on_site:"seconds_on_site",trigger_once:"trigger_once",scroll_on_small_page:"scroll_on_small_page",navigation_start_page:"navigation_start_page",navigation_end_page:"navigation_end_page",a_to_b_page_transition_time:"a_to_b_page_transition_time",utm_source:"utm_source",utm_medium:"utm_medium",utm_campaign:"utm_campaign"};
UMA.helpers={checkIsScrollable:function(){return document.body.offsetHeight>document.documentElement.clientHeight},checkIsOusideBody:function(e){var n=e.clientX,e=e.clientY;return n<=0||e<=0||n>=window.innerWidth||e>=window.innerHeight},checkIsBottomReached:function(){return window.innerHeight+window.scrollY>=document.body.offsetHeight},addInactivityListener:function(e){document.addEventListener("mousemove",e),document.addEventListener("mousedown",e),document.addEventListener("mouseup",e),document.addEventListener("keydown",e),document.addEventListener("keyup",e),document.addEventListener("scroll",e)},removeInactivityListener:function(e){document.removeEventListener("mousemove",e),document.removeEventListener("mousedown",e),document.removeEventListener("mouseup",e),document.removeEventListener("keydown",e),document.removeEventListener("keyup",e),document.removeEventListener("scroll",e)}};
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(r,e){var t,o=Object.keys(r);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(r),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),o.push.apply(o,t)),o}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return("string"===r?String:Number)(e);t=t.call(e,r||"default");if("object"!=_typeof(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){var t;if(e)return"string"==typeof e?_arrayLikeToArray(e,r):"Map"===(t="Object"===(t={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=Array(r);t<r;t++)o[t]=e[t];return o}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,n,i,a,l=[],c=!0,u=!1;try{if(i=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;c=!1}else for(;!(c=(o=i.call(t)).done)&&(l.push(o.value),l.length!==r);c=!0);}catch(e){u=!0,n=e}finally{try{if(!c&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(u)throw n}}return l}}function _arrayWithHoles(e){if(Array.isArray(e))return e}!function(){var r=null;UMA.utils={getQuery:function(){return location.search.replace(/^\?/,"").split("&").map(function(e){e=_slicedToArray(e.split("="),2);return[e[0],e[1]||""]}).reduce(function(e,r){var r=_slicedToArray(r,2),t=r[0],r=r[1];return e[t]=r,e},{})},replaceImageUrls:function(e){for(var r={},t=Object.keys(e),o=0;o<t.length;o++){var n=t[o];r[n]=_objectSpread({},e[n]),e[n].type===UMA.EVarType.image&&e[n].value&&(r[n].value=/^(https?:\/\/)/.test(e[n].value)?e[n].value:this.umaImages(e[n].value))}return r},umaApi:function(e){return _Mango.Urls.url(_Mango.ClientConfig.umaHost,"api",e)},umaImages:function(e){return _Mango.Urls.url(_Mango.ClientConfig.umaHost,"images",e)},orderCallback:function(e){return _Mango.Urls.url(_Mango.ClientConfig.callbackHost,"widget","order-call",btoa(e))},getPlatform:function(){var e;return null===r&&(e=window,e=navigator.userAgent||navigator.vendor||e.opera,r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4))?UMA.EPlatformType.mobile:UMA.EPlatformType.desktop),r}}}();
UMA.http={fetchScenarios:function(n,t,e,o){var a=UMA.utils.umaApi("scenarios/".concat(n));return new Promise(function(n){_Mango.httpClient.handleResponse(_Mango.httpClient.jsonp(a,{uid:t,sid:e,path:encodeURIComponent(o)}),n,[])})},fetchPopupInfo:function(n,t){var e=UMA.utils.umaApi("popups/".concat(n,"/").concat(t));return new Promise(function(n){_Mango.httpClient.handleResponse(_Mango.httpClient.jsonp(e,{}),n,null)})},makeScenarioReport:function(n,t){var e=UMA.utils.umaApi("scenario-report/".concat(n));return new Promise(function(n){_Mango.httpClient.handleResponse(_Mango.httpClient.jsonp(e,t),n,null)})},orderCallback:function(n,t){var e="".concat(UMA.utils.orderCallback(n),"?number=").concat(t,"&dateStart=0");return new Promise(function(n){_Mango.httpClient.handleResponse(_Mango.httpClient.jsonp(e,{}),n,null)})}};
UMA.analytics={sendGA:function(e){var t=e.action,r=e.category,n=e.label,e=e.value,a=function(){try{return window[window.GoogleAnalyticsObject].getAll()[0]}catch(e){return null}}();if(a)try{return void(e?a.send("event",r,t,n,e):a.send("event",r,t,n))}catch(e){}try{var c,o=gtag;"function"==typeof o&&(c={event_category:r,event_label:n},e&&(c.value=e),o("event",t,c))}catch(e){}},sendYM:function(e){var t=e.targetName,e=e.orderPrice,r=Ya,n=Object.keys(r._metrika.counters)[0];n&&(e?r._metrika.counters[n].reachGoal(t,{order_price:e,currency:"RUB"}):r._metrika.counters[n].reachGoal(t))}};
!function(){var r,h=!(UMA.addActions=function(e,t){for(var n=t.actions,o=0;o<n.length;o++){var a=n[o];a.type===UMA.EActionType.popup&&!function(I,M,E){function n(e){var n,t,o,a,c,i,r,d,p,s,u;e=e||{},h||e.widgetId&&e.widgetId!==I.widgetId||e.scenarioId&&e.scenarioId!==I.id||(y&&g&&m?(h=!0,g.render(m),e=I,n=E,t=l,o=UMA,a=o.http,c=o.debug,i=o.EEventType,r=o.EActionType,d=o.analytics,o=o.user,p=e.id,s=e.widgetId,o.triggerScenario(p),u=i.uma_trigger,c("trigger scenario ".concat(p)),e=Mango.session.getSessionId(),a.makeScenarioReport(p,{eventType:u,sid:e,widgetId:s,actionType:r.popup,templateType:t}).then(function(){if(window[MangoObject].exec("calltracking:".concat(s),"hit"),n){try{var e;n.ga&&(e=n.ga[u],d.sendGA(e))}catch(e){}try{var t;n.ym&&(t=n.ym[u],d.sendYM(t))}catch(e){}}})):f=!0)}var g,m,l,e=UMA,t=e.http,o=e.utils,a=e.EPopupEvents,A=e.debug,P=e.ETemplateType,c=e.error,i=document.getElementsByTagName("body")[0],y=!1,f=!1;M.actions.push(n),function(){{var e;r||(e=document.createElement("div"),r=e.attachShadow?Promise.resolve():new Promise(function(e,t){var n=document.createElement("script");n.async=!0,n.src="https://unpkg.com/@webcomponents/webcomponentsjs@2.4.2/webcomponents-bundle.js",document.body.appendChild(n),n.onload=function(){e()},n.onerror=function(e){t(e)}}))}return r}().then(function(){return t.fetchPopupInfo(I.widgetId,E.popupId)}).then(function(e){var T,b,t;e&&(T=e.templateType,t=e.vars,b=e.id,l=T,m=o.replaceImageUrls(t),"function"==typeof _Mango.Popup)&&(e="app_root-".concat(T),(t=document.createElement("div")).setAttribute("id",e),i.appendChild(t),(g=new _Mango.Popup({mountPoint:t,templateType:T,umaHost:_Mango.ClientConfig.umaHost,vars:m,preloadResources:!0})).on(a.loaded,function(){A(a.loaded),y=!0,f&&n({templateType:T})}),g.on(a.close,function(){g.destroy(),h=!1}),g.on(a.action,function(e){try{A("Target action - ".concat(JSON.stringify(e))),T===P.contacts&&(t=E.callbackButtonId,n=e.phone,o=e.name,a=e.email,c=M.widgetParams.widget_id,i=window[window.MangoObject],t&&n?i.exec("uma:".concat(c),"createCallbackRequest",t,n):(r={name:o,number:n,email:a,fid:b,subType:"uma"},i.exec("calltracking:".concat(c),"postForm",r)));var t,n,o,a,c,i,r,d,p,s=I,u=E,g=e,m=T,l=(w=UMA).http,y=w.debug,f=w.EEventType,h=w.EActionType,w=w.analytics,v=s.id,s=s.widgetId,f=f.uma_action,y=(y("scenario ".concat(v," target action")),Mango.session.getSessionId());if(l.makeScenarioReport(v,{eventType:f,sid:y,widgetId:s,actionType:h.popup,payload:g,templateType:m}),u){try{u.ga&&(d=u.ga[f],w.sendGA(d))}catch(e){}try{u.ym&&(p=u.ym[f],w.sendYM(p))}catch(e){}}}catch(e){}}),g.on("resources-load-error",function(e){c(e)}))}).catch(function(e){UMA.debug(e)})}(t,e,a.payload)}})}();
!function(){function g(e,n,t){var r=UMA,i=r.EConditionType,a=r.user;try{var o=t.type,u=t.value;switch(o){case i.url_match:var c=location.pathname+location.hash,d=function(e){return 0===c.indexOf(e)};return u.reduce(function(e,n){return Boolean(e)||d(n)},Boolean(d(u[0])));case i.utm_campaign:case i.utm_medium:case i.utm_source:var g=window[MangoObject].exec("calltracking","getUtm"),m=g.src,f=g.mdm,l=g.cmp;return o===i.utm_campaign&&-1!==u.indexOf(l)||o===i.utm_medium&&-1!==u.indexOf(f)||o===i.utm_source&&-1!==u.indexOf(m);case i.region:var s=a.getRegion();return-1!==u.indexOf(s);case i.trigger_once:return a.shouldTriggerScenario(e.id,u);default:return!0}}catch(e){return!1}}UMA.handleConditions=function(e,n,t){for(var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=UMA.EConditionType,a={type:i.trigger_once,value:!1},o=0;o<t.length;o++){var u=t[o],c=u.type,d=u.value;if("function"==typeof r[c]&&r[c](d),u.type===i.trigger_once)a=u;else if(!g(e,0,u))return!1}return g(e,0,a)}}();
function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function ownKeys(e,r){var t,n=Object.keys(e);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(e),r&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,t)),n}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(r,e,t){return(e=_toPropertyKey(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _toPropertyKey(r){r=_toPrimitive(r,"string");return"symbol"==_typeof(r)?r:r+""}function _toPrimitive(r,e){if("object"!=_typeof(r)||!r)return r;var t=r[Symbol.toPrimitive];if(void 0===t)return("string"===e?String:Number)(r);t=t.call(r,e||"default");if("object"!=_typeof(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(){var f=[],a={};UMA.cart={getItems:function(){return f.slice(0,3).map(function(r){return _objectSpread({},r)})},addToCart:function(i){if(!Array.isArray(i))throw new Error("expected an array");for(var r=0;r<i.length;r++){var e=i[r],t=e.id,n=e.name,o=e.price,e=e.oldPrice;if("string"!=typeof t||0===t.length)throw new Error("id should be a not empty string");if("string"!=typeof n||0===n.length)throw new Error("name should be a not empty string");if(o&&("number"!=typeof o||o<0))throw new Error("price should be a not negative number");if(e&&("number"!=typeof e||e<0))throw new Error("price should be a not negative number")}for(var c=0;c<i.length;c++)!function(){var r,e=i[c],t=e.id,n=e.name,o=e.price,e=e.oldPrice;a[t]?(r=f.find(function(r){return r.id===t}),UMA.debug("change in cart: ".concat(JSON.stringify(r))),r.name=n,o?r.price=o:delete r.price,e?r.oldPrice=e:delete r.oldPrice,UMA.debug("replace in cart: ".concat(JSON.stringify(r)))):(r={id:t,name:n},o&&(r.price=o),e&&(r.oldPrice=e),f.push(r),UMA.debug("add to cart: ".concat(JSON.stringify(r))),a[t]=!0)}()},removeFromCart:function(r){if(!Array.isArray(r))throw new Error("expected an array");for(var e=0;e<r.length;e++){var t=r[e];if("string"!=typeof t||0===t.length)throw new Error("id should be a not empty string")}for(var n={},o=0;o<r.length;o++){var i=r[o];delete a[i],n[i]=!0}f=f.filter(function(r){return!n[r.id]})},clearCart:function(){f=[],a={}}}}();
!function(){var r,n="mango-uma:session",e="mango-uma:navigation",a="mango-uma:trigger-history";function i(t,r){return{sid:t,tsp:r}}function s(){return Mango.session.getSessionId()}function u(){return Mango.session.getUserId()}function o(t,r){localStorage.setItem(t,JSON.stringify(r))}UMA.user={init:function(t){r=t},getRegion:function(){return r.session.location.region_code},getSession:function(){var t=null,r=s();try{t=JSON.parse(localStorage.getItem(n))}catch(t){UMA.error(t)}return t&&t.sid===r||(t=i(r,Date.now()),o(n,t)),t},triggerScenario:function(n){var e=u(),t=[];try{t=JSON.parse(localStorage.getItem(a))||t}catch(t){return!1}(t=t.filter(function(t){var r=t.id,t=t.uid;return r!==n||t!==e})).push({id:n,uid:e,sid:s()}),localStorage.setItem(a,JSON.stringify(t))},shouldTriggerScenario:function(n,t){var e=u(),r=!1;try{var i=JSON.parse(localStorage.getItem(a));if(!i)return!0;var o=i.find(function(t){var r=t.id,t=t.uid;return r===n&&t===e});if(!o)return!0;if(o.sid===s())return!1;r=o.uid===e}catch(t){UMA.error(t)}return!t||!r},getNavigationSession:function(){var t=s();try{var r=JSON.parse(localStorage.getItem(e));return r&&r.sid===t?r:null}catch(t){UMA.error(t)}return null},createNavigationSession:function(){var t=i(s(),Date.now());o(e,t)},completeNavigationSession:function(){var t=null,r=s();try{t=JSON.parse(localStorage.getItem(e))}catch(t){UMA.error(t)}t&&t.sid===r&&(t.navigationCompleted=!0,o(e,t))},getUid:u,getSid:s}}();
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,r){if("object"!=_typeof(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return("string"===r?String:Number)(e);t=t.call(e,r||"default");if("object"!=_typeof(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}var _Mango=Mango;_Mango.UMA={},_Mango.UMA.Module=function(){return _createClass(function e(r){_classCallCheck(this,e),r&&r[0]&&(this._params=r[0])},[{key:"start",value:function(){var a,n,o=this,e=UMA,r=e.debug,t=e.user,i=e.http,c=e.ETrigger,l=e.utils,s=e.EPlatformType,u=e.triggerHandlerFactories,e=e.error;r("uma started"),this._params&&(n=a=!1,t.init(this._params),r=t.getUid(),t=t.getSid(),i.fetchScenarios(this._params.id,r,t,location.pathname).then(function(e){for(var r=0;r<e.length;r++){var t=e[r];switch(t.trigger){case c.leave_page:a||(a=!0,l.getPlatform()!==s.mobile&&u.createLeavePageTriggerHandler(t,o._params));break;case c.scroll_to_bottom:n||(n=!0,u.createScrollToBottomTriggerHandler(t,o._params));break;case c.manual_trigger:u.createManualTriggerHandler(t,o._params);break;case c.spent_time_page:u.createSpentTimePageHandler(t,o._params);break;case c.spent_time_site:u.createSpentTimeSiteHandler(t,o._params);break;case c.enter_page:u.createEnterPageHandler(t,o._params);break;case c.enter_site:u.createEnterSiteHandler(t,o._params);break;case c.break_navigation:u.createBreakNavigationHandler(t,o._params)}}}).catch(e))}},{key:"exec",value:function(e,r){if("function"!=typeof this[r])return!1;for(var t=arguments.length,a=new Array(2<t?t-2:0),n=2;n<t;n++)a[n-2]=arguments[n];return this[r].apply(this,[e].concat(a)),!0}},{key:"triggerScenario",value:function(e,r){var t=UMA,t=t.handledScenarios[t.ETrigger.manual_trigger];t&&t.handler(e,r)}},{key:"createCallbackRequest",value:function(e,r,t){UMA.http.orderCallback(r,t)}},{key:"addToCart",value:function(e,r){UMA.cart.addToCart(r)}},{key:"removeFromCart",value:function(e,r){UMA.cart.removeFromCart(r)}},{key:"clearCart",value:function(){UMA.cart.clearCart()}}])}();
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,n){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(){var g=UMA.TIME.SECOND,m=UMA.ETrigger.break_navigation;UMA.triggerHandlerFactories.createBreakNavigationHandler=function(e,t){var n=UMA,o=n.handledScenarios,i=n.handleConditions,r=n.EConditionType,a=n.TIME,c=n.addActions,f=n.user,s=n.debug,l=o[m];if(!l){var l={widgetParams:t,actions:[],handler:function(t){for(var e=0;e<l.actions.length;e++)l.actions[e](t)}},p=-1,n=e.conditions,d=!1,u=!1,t=i(e,m,n,_defineProperty(_defineProperty(_defineProperty({},r.navigation_start_page,function(t){d=0===location.pathname.indexOf(t)}),r.navigation_end_page,function(t){u=0===location.pathname.indexOf(t)}),r.a_to_b_page_transition_time,function(t){p=t*a.SECOND}));if(t&&!(p<0)){var v,i=function(){var t=f.getNavigationSession();t?t.navigationCompleted?(s("navigation completed in another tab - stop ".concat(m," timer")),clearInterval(v)):(t=Date.now()-t.tsp,p<t?(s("navigation not completed - ".concat(m," timer expired")),f.completeNavigationSession(),l.handler(e.id),clearInterval(v)):s("".concat(Math.floor((p-t)/a.SECOND)," s before triggering an action"))):(s("session not found - stop ".concat(m," timer")),clearInterval(v))};if(d){n=f.getNavigationSession();if(n){if(n.navigationCompleted)return void s("".concat(m," session already completed, abort"))}else f.createNavigationSession();s("start ".concat(m," timer"))}else{if(u)return s("end page visited - stop ".concat(m," timer")),void f.completeNavigationSession();r=f.getNavigationSession();if(!r||r.navigationCompleted)return}v=setInterval(i,g),c(l,e),o[m]=l}}}}();
!function(){var o=UMA.ETrigger.enter_page;UMA.triggerHandlerFactories.createEnterPageHandler=function(n,a){var e=UMA,r=e.handledScenarios,i=e.handleConditions,e=e.addActions,t=r[o];t||(t={widgetParams:a,actions:[],handler:function(){for(var n=0;n<t.actions.length;n++)t.actions[n]()}},a=n.conditions,i(n,o,a)&&(e(t,n),(r[o]=t).handler()))}}();
!function(){var o=UMA.ETrigger.enter_site;UMA.triggerHandlerFactories.createEnterSiteHandler=function(n,e){var i=UMA,a=i.handledScenarios,r=i.handleConditions,i=i.addActions,t=a[o]||{widgetParams:e,actions:[],handler:function(n){for(var e=0;e<t.actions.length;e++)t.actions[e](n)}},e=n.conditions;r(n,o,e)&&(i(t,n),(a[o]=t).handler(n.id))}}();
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,o){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0===o)return("string"===t?String:Number)(e);o=o.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(){var d=UMA.ETrigger.leave_page,s="mouseout";UMA.triggerHandlerFactories.createLeavePageTriggerHandler=function(e,t){var o,n,r,i=UMA,u=i.handledScenarios,a=i.handleConditions,c=i.EConditionType,f=i.TIME,y=i.addActions,l=i.helpers;u[d]||(o=!1,n={widgetParams:t,actions:[],handler:function(e){if(l.checkIsOusideBody(e)&&!o){o=!0,document.removeEventListener(s,n.handler);for(var t=0;t<n.actions.length;t++)n.actions[t]()}}},r=0,i=e.conditions,a(e,d,i,_defineProperty({},c.seconds_on_page,function(e){r=e*f.SECOND}))&&(setTimeout(function(){document.addEventListener(s,n.handler)},r),y(n,e),u[d]=n))}}();
!function(){var t=UMA.ETrigger.manual_trigger;UMA.triggerHandlerFactories.createManualTriggerHandler=function(a,r){var n=UMA,e=n.handledScenarios,n=n.addActions,i=e[t]||{widgetParams:r,actions:[],handler:function(a,r){for(var n=0;n<i.actions.length;n++)i.actions[n]({widgetId:a,scenarioId:r})}};n(i,a),e[t]=i}}();
!function(){var u=UMA.ETrigger.scroll_to_bottom,E="scroll",T=3*UMA.TIME.SECOND;UMA.triggerHandlerFactories.createScrollToBottomTriggerHandler=function(e,n){var t,o=UMA,r=o.handledScenarios,a=o.handleConditions,i=o.EConditionType,c=o.TIME,l=o.addActions,s=o.helpers,o=r[u],d=(o||(t=s.checkIsScrollable()?{widgetParams:n,actions:[],handler:function(){if(s.checkIsBottomReached()){document.removeEventListener(E,t.handler);for(var e=0;e<t.actions.length;e++)t.actions[e]()}}}:{widgetParams:n,actions:[],handler:function(){for(var e=0;e<t.actions.length;e++)t.actions[e]()}}),e.conditions);if(a(e,u,d)){if(o)t=o;else if(s.checkIsScrollable())document.addEventListener(E,t.handler);else{for(var h=-1,f=T,v=0;v<d.length;v++){var g=d[v],m=g.type,g=g.value;m===i.scroll_on_small_page&&(f=g*c.SECOND)}n=function e(){clearTimeout(h),h=setTimeout(function(){s.removeInactivityListener(e),t.handler()},f)};s.addInactivityListener(n),n()}l(t,e),r[u]=t}}}();
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,o){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0===o)return("string"===e?String:Number)(t);o=o.call(t,e||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(){var y=UMA.ETrigger.spent_time_page;UMA.triggerHandlerFactories.createSpentTimePageHandler=function(t,e){var o,n=UMA,r=n.handledScenarios,i=n.handleConditions,a=n.EConditionType,f=n.TIME,n=n.addActions,u=r[y];u||(u={widgetParams:e,actions:[],handler:function(){for(var t=0;t<u.actions.length;t++)u.actions[t]()}},o=-1,e=t.conditions,!i(t,y,e,_defineProperty({},a.seconds_on_page,function(t){o=t*f.SECOND})))||o<0||(setTimeout(u.handler,o),n(u,t),r[y]=u)}}();
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,n){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(){var y=UMA.TIME.SECOND,d=UMA.ETrigger.spent_time_site;function p(){var t=UMA.user.getSession();return Date.now()-t.tsp}UMA.triggerHandlerFactories.createSpentTimeSiteHandler=function(e,t){var n,r=UMA,o=r.handledScenarios,i=r.handleConditions,a=r.EConditionType,u=r.TIME,s=r.addActions,c=r.debug,f=o[d]||{widgetParams:t,actions:[],handler:function(t){for(var e=0;e<f.actions.length;e++)f.actions[e](t)}},l=-1,r=e.conditions;!i(e,d,r,_defineProperty({},a.seconds_on_site,function(t){l=t*u.SECOND}))||l<0||(s(f,e),o[d]=f,p()<l?(n=setInterval(function(){var t=p();l<t?(f.handler(e.id),clearInterval(n)):c("".concat(Math.floor((l-t)/u.SECOND)," s before triggering an action"))},y),c("start measuring session duration")):(f.handler(e.id),c("session duration is already greater then condition time")))}}();