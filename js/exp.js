"use strict";(()=>{(function(c,f){let y=c.ymab;if("ymab"in c&&typeof y=="function"&&y.inited)return;let L=c.requestAnimationFrame,h=c.location,q=c.history,Ce=10,Te=5e3,G=100,ve=10*1e3/G,w={},k={},K={},I={enableRedir:!0,enableVisual:!0,enableHTML:!0,enableJS:!1,enableWatch:!1,enableAdv:!0,storeRedirParam:!0,removeAbRedirParam:!1,metrikaTimeout:100,cookieDomain:void 0,nonce:void 0,storeReferer:!1},Se={enableRedir:["boolean"],enableVisual:["boolean"],enableHTML:["boolean"],enableJS:["boolean"],enableWatch:["boolean"],enableAdv:["boolean"],cookieDomain:["string"],metrikaTimeout:["number"],storeRedirParam:["boolean","string"],removeAbRedirParam:["boolean"],storeReferer:["boolean"],nonce:["string"]},S={},Re="https://uaas.yandex.ru/v1/exps/",X="_ymab_param",A=60,ke=A*60*24*365,Ie="wSIKtymTfos,",Y=/\/$/,C;function V({name:t,value:n,domain:e,ttl:r=ke}){let i=`${t}=${n}; path=/;`;if(h.protocol==="https:"&&(i+="SameSite=None; Secure;"),e){let a=e[0]==="."?1:0;h.hostname.indexOf(e.slice(a))>=0?i+=`domain=${e};`:console.error(`cookieDomain=${e} is not valid for current hostname`)}f.cookie=i+`max-age=${r};`}function W(t){let n=new RegExp(`(?:^|; )${t}=([^;]*)`,"g"),e,r;for(;(r=n.exec(f.cookie))!==null;)e=r[1];return e}function R(t,n){let e=t.indexOf(n);if(e===-1)return[];let r=t.slice(0,e).trim(),i=t.slice(e+1);return[r,i]}function Ae(t,n){return t.reduce((e,{t:r,n:i,v:a})=>{if(r==="visual"&&n.enableVisual){let[o,l]=R(a,"|");if(!o||l===void 0)return e;switch(i){case"css-insert":return e.cssInsert.unshift({selector:o,value:l}),e;case"text-insert":return e.textInsert.unshift({selector:o,value:l}),e;case"href-insert":return e.hrefInsert.unshift({selector:o,value:l}),e;case"image-insert":return e.imageSrcInsert.unshift({selector:o,value:l}),e;case"html-replace":if(!n.enableHTML)break;return e.htmlReplace.unshift({selector:o,value:l}),e;case"js-insert":if(!n.enableJS)break;return e.jsInsert.unshift({selector:o,value:l}),e}}if(r==="redir"&&n.enableRedir)return e.redirect.push(a),e;if(r==="adv"&&n.enableAdv)return e.adv.push({type:i,value:a}),e;let s=e.flags[i];return s||(e.flags[i]=s=[]),s.push(a),e},{cssInsert:[],textInsert:[],redirect:[],hrefInsert:[],imageSrcInsert:[],htmlReplace:[],jsInsert:[],adv:[],flags:{}})}function Ee(t){return t?f.querySelector(t):void 0}function xe(t,n){let e=[];for(let{selector:r,value:i}of t){let a=i.trim();e.push(`${r} {${a}}`)}try{let r=f.createElement("style");r.nonce=n,r.setAttribute("type","text/css"),r.textContent=e.join(`
`).replace(/;/g," !important;"),f.body.appendChild(r)}catch(r){}}function Pe(t,n){try{let r=n.trim().split(";");for(let i of r)if(i){let[a,s]=R(i,":");a&&s!==void 0&&(t.style[a]=s)}}catch(e){}}function Me(t,n,e,r){try{let i=f.createElement("script");i.nonce=t,i.setAttribute("type","text/javascript"),i.innerHTML=`(function(element){${e}})(document.querySelector('${r}'));`,f.body.appendChild(i)}catch(i){}}let z={};function B(t){if(z[t])return;let n=f.createElement("script");n.async=!0,n.type="text/javascript",n.src=t;let e=f.head;e.insertBefore(n,e.firstChild),z[t]=!0}let _e=new Set(["js-insert","css-insert"]),Z={cache:{},getItem(t,n){let e=this.cache[t];e||(e=this.cache[t]={});let r=e[n.selector];r||(r=e[n.selector]={});let i=r[n.value];return i||(i=r[n.value]=new Set),i},has(t,n,e){return _e.has(t)&&this.getItem(t,n).has(e)},add(t,n,e){return this.getItem(t,n).add(e)}};function Q(t,n,e,r){let{selector:i,value:a}=e;if(!i||a===void 0)return;let s=Ee(i);if(!s){r>0&&setTimeout(()=>Q(t,n,e,r-1),G);return}Z.has(t,e,s)||(n(s,a,i),Z.add(t,e,s))}function T(t,n,e,r){e.forEach(i=>Q(t,n,i,r?ve:0))}class Ue{constructor(){this.callbacks={};this.MAX_DEPTH=1e3;this.depth=0;this.started=!1;this.item=new c.MutationObserver(()=>{if(this.depth++>=this.MAX_DEPTH){this.item.disconnect(),L(()=>this.observe());return}Object.values(this.callbacks).forEach(n=>n()),clearTimeout(this.depthTimeout),this.depthTimeout=setTimeout(()=>{this.depth=0},0)})}observe(){this.item.observe(f.body,{subtree:!0,childList:!0,characterData:!0,attributes:!0,attributeFilter:["class"]})}start(n,e){this.callbacks[n]=e,this.started||(this.observe(),this.started=!0)}}let Fe=new Ue,Le=T.bind(null,"text-insert",(t,n)=>t.textContent===n||(t.textContent=n)),Ve=T.bind(null,"href-insert",(t,n)=>t.getAttribute("href")===n.trim()||t.setAttribute("href",n.trim())),Oe=T.bind(null,"image-insert",(t,n)=>t.getAttribute("src")===n.trim()||t.setAttribute("src",n.trim())),He=T.bind(null,"html-replace",(t,n)=>t.innerHTML===n||(t.innerHTML=n)),je=T.bind(null,"css-insert",Pe),Ne=(t,n,e)=>{T("js-insert",Me.bind(null,n),t,e)};function ee(t){var r,i;let n=`yaCounter${t}`,e=c[n];if(!e)try{let a=((i=(r=c.Ya)==null?void 0:r._metrika)==null?void 0:i.counters)||{},s=Object.keys(a).find(o=>o.indexOf(`${t}:`)===0);return a[s||""]}catch(a){}return e}let te=!1;function O(t,n){return new Promise(e=>{var a;let r=R(t,".")[1];if(r)try{(a=c.ym)==null||a.call(c,r,"experiments",n)}catch(s){}function i(){if(!r){console.error(`Bad clientId = ${t}`);return}let s=ee(r);if(!s){setTimeout(i,10);return}try{s.experiments(n)}catch(o){}te=!0,e(!0)}i()})}function $e(t,n){var r;let e=R(t,".")[1];if(e){let i=ee(e);i?i.hit(h.href,{referer:n}):(r=c.ym)==null||r.call(c,e,"hit",h.href,{referer:n})}}function De(t,n=h.href){if(t.length===0)return;let e=new URL(n),r=new URL(t,e.toString()),i=r.searchParams;r.protocol=e.protocol,r.hostname=e.hostname;let a=0,s=!0;if(e.searchParams.forEach((o,l)=>{if(l==="ab__exp_flags"||l==="vq__redir_param"){i.delete(l);return}let m=l==="ab_redir"||l==="vq__ab_redir",d=i.get(l);if(d===null){if(m)return;i.set(l,o)}else s&&!m&&d!==o&&(s=!1);a++}),s&&(s=a===Array.from(i.keys()).length),!s||e.pathname.replace(Y,"")!==r.pathname.replace(Y,""))return r}function Je(t,n,e){let r;for(let d of t)if(r=De(d),r)break;if(!r)return!1;let i=0;try{ne(n,e,r,()=>i=n.metrikaTimeout)}catch(d){i=n.metrikaTimeout}let a=r.toString(),s,o;function l(){clearTimeout(o),clearTimeout(s),h.replace(a)}o=setTimeout(l,i);function m(){if(!te){s=setTimeout(m,10);return}l()}return m(),!0}function ne(t,n,e,r){if(n){if(t.storeReferer&&f.referrer)try{let i={referer:f.referrer,url:h.href,ts:Date.now()};c.sessionStorage.setItem("vq__referer",JSON.stringify(i))}catch(i){}switch(t.storeRedirParam){case!0:case"localstorage":let i={experiments:n,ts:Date.now(),target:e.toString()};c.localStorage.setItem("vq__redir_param",JSON.stringify(i));break;case"cookie":V({name:"vq__redir_param",value:n,ttl:5*A,domain:t.cookieDomain});break;case"get":e.searchParams.set("vq__redir_param",n);break;default:r()}}}function qe(t,n,e){if(typeof e!="string"||e.length===0)return;let r=e;try{let i=new URL(e,h.href);ne(t,n,i,()=>console.error("storeRedirParam is required")),r=i.toString()}catch(i){console.error(i)}return r}function Ge(t){if(!C||typeof C!="object")return;C[t]===!0&&(C[t]=!1);let{callback:n}=C;if(n){for(let[e,r]of Object.entries(C)){let[i,a]=R(e,".");if(!(!i||!a)&&r===!0&&i.length>0&&!isNaN(Number(a)))return}setTimeout(n,0)}}function we(t,n){let e=6,r=0;function i(){var a;try{for(;r<n.length;r++)(a=n[r])==null||a.call(null,t)}catch(s){e-- >0?setTimeout(i,50):console.error(s)}}i()}function re(t,n,e){(S[t]||I).removeAbRedirParam&&(H("ab_redir"),H("vq__ab_redir")),e.length&&we(n,e),Ge(t)}function H(t){let n=new URL(h.href),e=n.searchParams;if(e.has(t)){let r=e.get(t);try{e.delete(t),q.replaceState(q.state,"",n.toString())}catch(i){}return r||void 0}}function Ke(t){try{switch(t.storeRedirParam){case"cookie":{let n=W("vq__redir_param");return V({name:"vq__redir_param",value:"",ttl:0,domain:t.cookieDomain}),n}case"get":return H("vq__redir_param");case"localstorage":case!0:{let n=c.localStorage,e=n.getItem("vq__redir_param"),r;if(e){let i=JSON.parse(e);i.ts>Date.now()-5*A*1e3&&(r=i.experiments)}return n.removeItem("vq__redir_param"),r||void 0}}}catch(n){}}function E(t,n,e,r){if(typeof t!="string")throw new Error("clientId: should be string");K[t]=!0;let i=Ce,a=new URL(Re),s=a.searchParams;s.set("client_id",String(t)),s.set("url",h.href),s.set("i",n||W(X)||""),e&&s.set("client_features",JSON.stringify(e));let o=a.toString(),l=k[o];if(l)return r(l);let m=w[o]||(w[o]=[]);if(m.push(r),m.length>1)return;function d(){if(k[o])return;let u={flags:{},i:n,experiments:void 0,prepareUrl:g=>typeof g=="string"?g:void 0};k[o]=u,O(t,Ie),re(t,u,m)}let x=setTimeout(d,Te);function P(u){var me,pe;let g=S[t]||I,{flags:Ye,cssInsert:M,textInsert:ae,hrefInsert:oe,jsInsert:le,imageSrcInsert:ce,redirect:ue,htmlReplace:fe,adv:de}=Ae(u.flags,g),_=Object.assign({},u,{flags:Ye,prepareUrl:qe.bind(null,g,u.experiments)});u.i&&(n=u.i);let D=Ke(g),v=Promise.resolve();D&&D!==u.experiments&&(v=v.then(()=>O(t,D))),v=v.then(()=>O(t,u.experiments));try{let p=c.sessionStorage,U=p.getItem("vq__referer");if(U){let b=JSON.parse(U);b&&b.ts>Date.now()-5*A*1e3&&b.url===f.referrer&&(v=v.then(()=>{$e(t,b.referer),p.removeItem("vq__referer")}))}}catch(p){}clearTimeout(x),k[o]=_,_.i&&V({name:X,value:_.i,domain:g.cookieDomain});function ge(p=!1){fe.length&&He(fe,p),oe.length&&Ve(oe,p),ce.length&&Oe(ce,p),ae.length&&Le(ae,p),M.length&&je(M,p),le.length&&Ne(le,g.nonce,p)}function We(){g.enableVisual&&(M.length&&xe(M,g.nonce),g.enableWatch&&Fe.start(t,ge),ge(!g.enableWatch)),re(t,_,m)}function ze(){for(let{type:p,value:U}of de)try{let b=JSON.parse(U);if(typeof b!="object"||b===null)continue;c.yaContextCb.push(()=>{var be,ye;let J=(ye=(be=c.Ya)==null?void 0:be.Context)==null?void 0:ye.AdvManager;if(!J)return;let he=J.getPlatform(),F=b[he];F&&F.id&&J.render({type:p,platform:he,blockId:F.id,renderTo:F.renderTo})})}catch(b){}}(!ue.length||!Je(ue,g,u.experiments))&&(L(We),de.length&&(c.yaContextCb||(c.yaContextCb=[]),(pe=(me=c.Ya)==null?void 0:me.Context)!=null&&pe.AdvManager||B("https://yandex.ru/ads/system/context.js"),L(ze)))}function $(){if(--i>0)return ie(o,P,$);clearTimeout(x),d()}try{localStorage.removeItem("vq__redirect_param")}catch(u){}ie(o,P,$)}function ie(t,n,e){let r=new XMLHttpRequest;return r.open("GET",t),r.addEventListener("load",function(){if(r.status===200){try{let i=JSON.parse(r.responseText);n(i)}catch(i){i instanceof Error&&e(i.message)}return}e(r.statusText)}),r.addEventListener("error",()=>e(r.statusText)),r.send()}let j={init:(t,n,e,r)=>{E(t,n,e,i=>r&&r(i))},getFlags:(t,n,e,r)=>{E(t,n,e,i=>r&&r(i.flags))},getExperiments:(t,n,e,r)=>{E(t,n,e,i=>r&&r(i.experiments))},getParam:(t,n,e,r)=>{E(t,n,e,i=>r&&r(i.i))},setConfig:(t,n,e,r)=>{se(t,e),r&&r()},getConfig:(t,n,e,r)=>{let i=S[t]||I,a=Object.assign({},i);delete a.nonce,r&&r(a)}};function se(t,n){var e;if(typeof n=="object"){let r=S[t]||(S[t]=Object.assign({},I)),i=Object.keys(n);for(let a of i)if(a in r){let s=a,o=n[s];(e=Se[s])!=null&&e.includes(typeof o)&&(r[s]=o)}}}function Xe(t){let{clientId:n,config:e}=t;if(!n)throw new Error("clientId is required");se(n,e),j.init(n,t.i,t.clientFeatures,t.callback)}function N(t,n,e,r,i){if(typeof t=="object")return Xe(t);if(!n)throw new Error("method not specified");if(!(n in j))throw new Error("unknown method");typeof r=="function"&&(i=r,r={}),typeof e=="function"&&(i=e,e=void 0),typeof e=="object"&&(r=e,e=void 0),r||(r={}),j[n](t,e,r,i)}y&&(Array.isArray(y.a)&&y.a.forEach(t=>N.apply(null,t)),typeof y.antiFlicker=="object"&&(C=y.antiFlicker)),N.inited=!0,c.ymab=N,function(t){let n=["ru","ua","by","kz","com","com.tr"];function e(s){if(!s)return null;if(typeof s!="string")return s;try{return JSON.parse(s)}catch(o){return null}}function r(s,o){/^(\d\.)+\d+$/.test(o)&&/^[a-z0-9-]+$/ig.test(s)&&B(`https://abt.s3.yandex.net/${s}/v${o}/main.js`)}function i(s){let o=new URL(s),{hostname:l,protocol:m}=o,d=(l==null?void 0:l.split("."))||[];d[1]==="test"&&d.splice(1,1);let[x,P]=d,u=d.slice(2).join(".");return m==="https:"&&x==="ab"&&P==="yandex"&&n.indexOf(u)!==-1}function a(s){let o=s.origin;if(!o||!i(o))return;let l=e(s.data);if(!(!l||!K[l.clientId]))switch(l.type){case"appendplugin":r(l.plugin,l.version);break}}t.addEventListener("message",a)}(c)})(window,document);})();
